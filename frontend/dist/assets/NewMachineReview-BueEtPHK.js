import{r as s,u as R,j as r,f as N,M as y}from"./index-CivGSquN.js";import{p as E}from"./axiosMachine-BVJLXleH.js";import{B as S,R as C}from"./Rating-DCjIB3l-.js";const F=({machineId:n,onReviewAdded:v})=>{const[u,c]=s.useState({rating:0,review:""}),[h,g]=s.useState(!1),[d,t]=s.useState(null),w=R(),a=s.useRef(null),{rating:i,review:m}=u,f=()=>{a.current&&(a.current.style.height="auto",a.current.style.width="100%",a.current.style.height=`${a.current.scrollHeight}px`)};s.useEffect(()=>{f()},[m]);const x=o=>{const{name:e,value:l}=o.target;c(j=>({...j,[e]:e==="rating"?parseFloat(l):l}))},p=(o,e)=>{c(l=>({...l,rating:e||0}))},b=async o=>{if(o.preventDefault(),t(null),i<1||i>5){t("Rating must be between 1.0 and 5.0.");return}if(!Number.isInteger(i*10)){t("Rating must have at most one decimal place.");return}if(!m.trim()){t("Please write your review.");return}g(!0);try{const e=await E(n,u);v(e),c({rating:0,review:""}),w(`/machine/${n}`)}catch(e){e.response&&e.response.data&&e.response.data.msg?t(`Error submitting review: ${e.response.data.msg}`):e.msg?t(`Error submitting review: ${e.msg}`):t("Error submitting review: Unknown error.")}finally{g(!1)}};return r.jsxs("form",{className:"machine-review-form",onSubmit:b,children:[r.jsx("h2",{children:"New Review"}),d&&r.jsx("p",{className:"error-message",children:d}),r.jsxs("div",{className:"machine-review-form-rating",children:[r.jsx("label",{htmlFor:"rating",className:"rating",children:"Rating"}),r.jsx(S,{sx:{"& > legend":{mt:2}},children:r.jsx(C,{name:"rating",className:"test",value:i,precision:.5,onChange:p})})]}),r.jsxs("div",{className:"machine-review-form-content",children:[r.jsx("label",{htmlFor:"review",children:"Comment"}),r.jsx("textarea",{ref:a,id:"review",name:"review",value:m,placeholder:"Please write your review here",onChange:x,required:!0})]}),r.jsx("button",{className:"machine-review-form-submit",type:"submit",disabled:h,children:h?"Submitting...":"Submit"})]})},P=()=>{const{machineId:n}=N();return r.jsx(y,{children:r.jsx(F,{machineId:n||"",onReviewAdded:()=>{}})})};export{P as default};
//# sourceMappingURL=NewMachineReview-BueEtPHK.js.map
