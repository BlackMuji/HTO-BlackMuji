{"version":3,"file":"MachinesManagement-CMgPxmgo.js","sources":["../../src/pages/admin/MachinesManagement.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Sidebar from '../../components/admin/AdminSidebar';\r\nimport DataTable from '../../components/admin/DataTable/DataTable';\r\nimport ActionButtons from '../../components/admin/ActionButtons';\r\nimport ConfirmationModal from '../../components/admin/ConfirmationModal';\r\nimport ErrorMessage from '../../components/admin/ErrorMessage';\r\nimport {\r\n  getAllMachines,\r\n  activateMachine,\r\n  deactivateMachine,\r\n  deleteMachine,\r\n} from '../../api/axiosMachine';\r\n\r\ninterface Machine {\r\n  _id: string;\r\n  name: string;\r\n  isActive: boolean;\r\n}\r\n\r\nconst MachinesManagement: React.FC = () => {\r\n  const [machines, setMachines] = useState<Machine[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [modal, setModal] = useState<{ isOpen: boolean; machineId?: string; action?: string }>({\r\n    isOpen: false,\r\n    machineId: undefined,\r\n    action: undefined,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchMachines = async () => {\r\n      try {\r\n        const res = await getAllMachines();\r\n        setMachines(res.machines);\r\n      } catch (err: any) {\r\n        console.error('Error fetching machines:', err);\r\n        setError('Failed to load machines.');\r\n      }\r\n    };\r\n\r\n    fetchMachines();\r\n  }, []);\r\n\r\n  const handleToggleActive = (machineId: string, currentStatus: boolean) => {\r\n    setModal({ isOpen: true, machineId, action: currentStatus ? 'deactivate' : 'activate' });\r\n  };\r\n\r\n  const handleDeleteMachine = (machineId: string) => {\r\n    setModal({ isOpen: true, machineId, action: 'delete' });\r\n  };\r\n\r\n  const confirmAction = async () => {\r\n    const { machineId, action } = modal;\r\n    if (!machineId || !action) return;\r\n\r\n    try {\r\n      if (action === 'activate') {\r\n        await activateMachine(machineId);\r\n        setMachines((prevMachines) =>\r\n          prevMachines.map((machine) =>\r\n            machine._id === machineId ? { ...machine, isActive: true } : machine\r\n          )\r\n        );\r\n      } else if (action === 'deactivate') {\r\n        await deactivateMachine(machineId);\r\n        setMachines((prevMachines) =>\r\n          prevMachines.map((machine) =>\r\n            machine._id === machineId ? { ...machine, isActive: false } : machine\r\n          )\r\n        );\r\n      } else if (action === 'delete') {\r\n        await deleteMachine(machineId);\r\n        setMachines((prevMachines) => prevMachines.filter((machine) => machine._id !== machineId));\r\n      }\r\n      setModal({ isOpen: false, machineId: undefined, action: undefined });\r\n    } catch (err: any) {\r\n      console.error(`Error performing ${action} on machine:`, err);\r\n      setError(`Failed to ${action} machine.`);\r\n      setModal({ isOpen: false, machineId: undefined, action: undefined });\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    { header: 'Name', accessor: 'name' },\r\n    { header: 'Active', accessor: 'isActive' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"admin-dashboard\">\r\n      <Sidebar />\r\n      <div className=\"admin-content\">\r\n        <h1>Machines Management</h1>\r\n        {error && <ErrorMessage message={error} />}\r\n        <DataTable\r\n          columns={columns}\r\n          data={machines.map(machine => ({\r\n            ...machine,\r\n            isActive: machine.isActive ? 'Yes' : 'No',\r\n          }))}\r\n          actions={undefined}\r\n        />\r\n        \r\n        {/* Render Action Buttons separately per row */}\r\n        <table className=\"data-table\">\r\n          <thead>\r\n            <tr>\r\n              {columns.map((col) => (\r\n                <th key={col.accessor}>{col.header}</th>\r\n              ))}\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {machines.map(machine => (\r\n              <tr key={machine._id}>\r\n                <td>{machine.name}</td>\r\n                <td>{machine.isActive ? 'Yes' : 'No'}</td>\r\n                <td>\r\n                  <ActionButtons\r\n                    onActivate={!machine.isActive ? () => handleToggleActive(machine._id, machine.isActive) : undefined}\r\n                    onDeactivate={machine.isActive ? () => handleToggleActive(machine._id, machine.isActive) : undefined}\r\n                    onDelete={() => handleDeleteMachine(machine._id)}\r\n                  />\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Confirmation Modal */}\r\n        <ConfirmationModal\r\n          isOpen={modal.isOpen}\r\n          title={\r\n            modal.action === 'activate'\r\n              ? 'Confirm Activate Machine'\r\n              : modal.action === 'deactivate'\r\n              ? 'Confirm Deactivate Machine'\r\n              : 'Confirm Delete Machine'\r\n          }\r\n          message={\r\n            modal.action === 'activate'\r\n              ? 'Are you sure you want to activate this machine?'\r\n              : modal.action === 'deactivate'\r\n              ? 'Are you sure you want to deactivate this machine?'\r\n              : 'Are you sure you want to delete this machine? This action cannot be undone.'\r\n          }\r\n          onConfirm={confirmAction}\r\n          onCancel={() => setModal({ isOpen: false, machineId: undefined, action: undefined })}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MachinesManagement; "],"names":["MachinesManagement","machines","setMachines","useState","error","setError","modal","setModal","useEffect","res","getAllMachines","err","handleToggleActive","machineId","currentStatus","handleDeleteMachine","confirmAction","action","activateMachine","prevMachines","machine","deactivateMachine","deleteMachine","columns","jsxs","jsx","Sidebar","ErrorMessage","DataTable","col","ActionButtons","ConfirmationModal"],"mappings":"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"}