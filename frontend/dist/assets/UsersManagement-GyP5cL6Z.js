import{r as o,j as s,ad as A,ae as j,af as p}from"./index-CivGSquN.js";import{D as v,A as U,C as y}from"./ConfirmationModal-KRM3RTXK.js";import{S as E,E as g}from"./AdminSidebar-DtRlde2w.js";const C=()=>{const[c,d]=o.useState([]),[m,l]=o.useState(null),[r,t]=o.useState({isOpen:!1,userId:void 0,action:void 0});o.useEffect(()=>{(async()=>{try{const a=await A();d(a.users)}catch(a){console.error("Error fetching users:",a),l("Failed to load users.")}})()},[]);const u=e=>{t({isOpen:!0,userId:e,action:"makeAdmin"})},f=e=>{t({isOpen:!0,userId:e,action:"delete"})},x=async()=>{const{userId:e,action:a}=r;if(!(!e||!a))try{a==="makeAdmin"?(await j(e),d(i=>i.map(n=>n._id===e?{...n,isAdmin:!0}:n))):a==="delete"&&(await p(e),d(i=>i.filter(n=>n._id!==e))),t({isOpen:!1,userId:void 0,action:void 0})}catch(i){console.error(`Error performing ${a}:`,i),l(`Failed to ${a==="makeAdmin"?"make admin":"delete"} user.`),t({isOpen:!1,userId:void 0,action:void 0})}},h=[{header:"Username",accessor:"username"},{header:"Email",accessor:"email"},{header:"Admin",accessor:"isAdmin"}];return s.jsxs("div",{className:"admin-dashboard",children:[s.jsx(E,{}),s.jsxs("div",{className:"admin-content",children:[s.jsx("h1",{children:"Users Management"}),m&&s.jsx(g,{message:m}),s.jsx(v,{columns:h,data:c.map(e=>({...e,isAdmin:e.isAdmin?"Yes":"No"})),actions:void 0}),s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[h.map(e=>s.jsx("th",{children:e.header},e.accessor)),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:c.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:e.username}),s.jsx("td",{children:e.email}),s.jsx("td",{children:e.isAdmin?"Yes":"No"}),s.jsx("td",{children:s.jsx(U,{onActivate:e.isAdmin?void 0:()=>u(e._id),onDelete:()=>f(e._id)})})]},e._id))})]}),s.jsx(y,{isOpen:r.isOpen,title:r.action==="makeAdmin"?"Confirm Promote to Admin":"Confirm Delete User",message:r.action==="makeAdmin"?"Are you sure you want to promote this user to admin?":"Are you sure you want to delete this user? This action cannot be undone.",onConfirm:x,onCancel:()=>t({isOpen:!1,userId:void 0,action:void 0})})]})]})};export{C as default};
//# sourceMappingURL=UsersManagement-GyP5cL6Z.js.map
