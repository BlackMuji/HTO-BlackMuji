import{j as e,r as m,u as _,h as y}from"./index-CivGSquN.js";import{f as F,h as E,s as H,i as R}from"./axiosContest-a7qLFL0E.js";import{f as U,h as S,i as C,j as I}from"./axiosMachine-BVJLXleH.js";import{s as M,d as D,g as P,a as j,T as k}from"./axiosInstance-ByXgwNmE.js";const J=({reward:n})=>e.jsx("div",{className:"reward-display",children:e.jsxs("h4",{children:["Reward: ",n," EXP"]})}),K=({machineId:n,playType:r,contestId:i,disabled:u=!1})=>{const[a,d]=m.useState([]),[l,o]=m.useState(!1),[f,t]=m.useState(null),[h,p]=m.useState(0),[g,c]=m.useState(0),x=async()=>{try{if(!i)throw new Error("Contest ID is missing.");const s=await F(i,n);s&&s.usedHints?(d(s.usedHints.map(v=>({content:v}))),p(s.hintsUsed),c(s.remainingHints)):(d([]),p(0),c(0))}catch(s){console.error("Error fetching used hints in contest:",s),t({msg:s.message||"Failed to fetch used hints in contest."})}},w=async()=>{try{const s=await U(n);s&&s.usedHints?(d(s.usedHints.map(v=>({content:v}))),p(s.hintsUsed),c(s.remainingHints)):(d([]),p(0),c(0))}catch(s){console.error("Error fetching used hints:",s),t({msg:"Failed to fetch used hints."})}},N=async()=>{o(!0),t(null);try{let s;if(r==="machine")s=await S(n);else if(r==="contest"){if(!i)throw new Error("Contest ID is missing for contest mode.");s=await E(i,n)}if(s!=null&&s.hint)d(v=>[...v,{content:s.hint}]),p(s.hintsUsed),c(s.remainingHints);else throw new Error("Invalid response from server.")}catch(s){console.error("Error fetching hint:",s),t({msg:s.msg||"Failed to fetch hint."})}finally{o(!1)}};return m.useEffect(()=>{r==="contest"?x():r==="machine"&&w()},[n,r,i]),e.jsxs("div",{className:"get-hints-container",children:[e.jsx("h3",{children:"Hints"}),l&&e.jsx("p",{children:"Loading hints..."}),f&&e.jsx("div",{className:"error-message",children:f.msg}),!l&&!f&&h>0&&e.jsxs("div",{className:"used-hints",children:[e.jsxs("h4",{children:["Used Hints (",h,")"]}),e.jsx("ul",{className:"hints-list",children:a.map((s,v)=>e.jsx("li",{children:s.content},v))})]}),!l&&!f&&g>0&&e.jsx("div",{className:"remaining-hints",children:e.jsxs("h4",{children:["Remaining Hints (",g,")"]})}),!l&&!f&&h===0&&e.jsx("p",{children:"No hints used yet."}),e.jsx("button",{onClick:N,disabled:l||g===0||u,className:"get-hints-button",children:l?"Loading...":g===0?"No More Hints":u?"Disabled":"Get Hint"})]})},Q=({machineId:n,onInstanceStarted:r})=>{const[i,u]=m.useState(!1),[a,d]=m.useState(null),l=async()=>{u(!0),d(null);try{const o=await M(n);console.log("Instance started successfully:",o),r()}catch(o){console.error("Error starting instance:",o),d(o.msg||"Failed to start instance.")}finally{u(!1)}};return e.jsxs("div",{className:"start-instance-button-container",children:[e.jsx("button",{onClick:l,disabled:i,className:"start-instance-button",children:i?"Starting...":"Start Instance"}),a&&e.jsx("div",{className:"error-message",children:a})]})},Z=()=>{const n=async()=>{var r,i,u;try{const a=await D(),d=new Blob([a.data],{type:"application/x-openvpn-profile"}),l=window.URL.createObjectURL(d),o=document.createElement("a");o.href=l,o.setAttribute("download","vpn-profile.ovpn"),document.body.appendChild(o),o.click(),(r=o.parentNode)==null||r.removeChild(o),window.URL.revokeObjectURL(l)}catch(a){console.error("Error downloading OpenVPN profile:",a),alert(((u=(i=a.response)==null?void 0:i.data)==null?void 0:u.msg)||"Failed to download OpenVPN profile.")}};return e.jsx("button",{onClick:n,className:"download-vpn-button",children:"Download VPN Profile"})},T=({machineId:n,onStatusChange:r})=>{const[i,u]=m.useState(null),[a,d]=m.useState(null),[l,o]=m.useState(!1);if(m.useEffect(()=>{if(!n){console.warn("InstanceInfo: machineId is not provided");return}let t=!0;const h=async()=>{o(!1);try{console.log("Fetching instance info for machineId:",n);const g=await P(n);if(console.log("Fetched instance data:",g),t)if(g.instance){const c=g.instance;u(c),r&&r(c.status)}else u(null),r&&r(null)}catch(g){console.error("Error fetching instance info:",g.message||g),t&&(d("Failed to fetch instance information."),r&&r(null))}finally{t&&o(!1)}};h();const p=setInterval(h,1e4);return()=>{t=!1,clearInterval(p)}},[n,r]),l)return e.jsx("div",{className:"instance-info-container",children:"Fetching instance information..."});if(a)return e.jsxs("div",{className:"instance-error",children:["Error: ",a]});if(!i)return e.jsx("div",{className:"instance-status",children:"Instance is pending"});const f=t=>{switch(t){case"stopped":case null:return"red";case"pending":return"yellow";case"running":return"green";default:return"black"}};return e.jsxs("div",{className:"instance-info-container",style:{border:"1px solid #ccc",padding:"10px",marginTop:"20px"},children:[e.jsxs("h4",{style:{color:f(i.status)},children:["Instance Status: ",i.status]}),e.jsxs("h4",{children:["VPN IP: ",i.vpnIp]})]})},ee=({machineId:n,playType:r,contestId:i,disabled:u=!1})=>{const[a,d]=m.useState(""),[l,o]=m.useState(""),[f,t]=m.useState([]),h=_(),p=async g=>{if(g.preventDefault(),!u){if(t([]),o(""),!n){t([{msg:"Machine ID is missing."}]);return}if(r==="contest"&&!i){t([{msg:"Contest ID is missing for contest mode."}]);return}if(!a.trim()){t([{msg:"Flag cannot be empty."}]);return}try{let c;if(r==="machine"){const x=await j(n,a);if(x.message==="ERROR"){t([{msg:x.cause}]);return}else if(c=await C(n,a),c.msg==="ERROR"){t([{msg:c.msg||"An error occurred."}]);return}o(c.msg||x.msg||"Flag submitted successfully!"),h(`/machine/${n}/complete`)}else if(r==="contest"){if(!i){t([{msg:"Contest ID is required for contest mode."}]);return}const x=await j(n,a);if(x.message==="ERROR"){t([{msg:x.cause}]);return}else c=await H(i,n,a);o(c.msg||x.msg||"Flag submitted successfully for contest!"),h(`/contest/${i}/complete`)}}catch(c){c.response&&c.response.data?t(c.response.data.errors||[{msg:c.response.data.msg||"An error occurred."}]):t([{msg:c.msg||c}])}}};return e.jsxs("div",{className:"submit-flag-form",children:[e.jsx("h3",{children:"Submit Flag"}),f.length>0&&e.jsx("div",{className:"error-messages",children:f.map((g,c)=>e.jsx("p",{className:"error",children:g.msg},c))}),l&&e.jsx("p",{className:"message",children:l}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"flag-input-group",children:[e.jsx("label",{htmlFor:"flag",children:"Flag:"}),e.jsx("input",{id:"flag",type:"text",value:a,onChange:g=>d(g.target.value),placeholder:"Enter flag here",required:!0,disabled:u})]}),e.jsx("button",{type:"submit",className:"submit-flag-button",disabled:u,children:u?"Disabled":"Submit Flag"})]})]})},O="_give_up_modal_pseg8_1",G="_textbox_pseg8_10",L="_text_pseg8_10",V="_warning_text_pseg8_21",A="_button_group_pseg8_26",B="_give_up_button_pseg8_39",$="_cancel_button_pseg8_53",b={give_up_modal:O,textbox:G,text:L,warning_text:V,button_group:A,give_up_button:B,cancel_button:$},q=({isOpen:n,onClose:r,machineId:i,contestId:u,machineName:a,mode:d})=>{const l=_(),o=async()=>{try{const f=await k(i);if(f){if(d==="machine"){const t=await I(i);t?l(`/machine/${i}`):alert(t.msg)}else if(d==="contest"){const t=await R(u||"");t?l(`/contest/${u}`):alert(t.msg)}}else alert(f.msg)}catch(f){console.error("Failed to give up:",f),alert("Failed to give up. Please try again.")}};return e.jsx(y,{isOpen:n,onClose:r,children:e.jsxs("div",{className:b.give_up_modal,children:[e.jsxs("div",{className:b.textbox,children:[e.jsx("div",{className:b.text,children:"Give Up Confirmation"}),e.jsxs("p",{children:["Are you sure you want to give up on ",e.jsx("strong",{children:a}),"?"]}),e.jsx("p",{className:b.warning_text,children:"Warning: All your progress will be lost!"})]}),e.jsxs("div",{className:b.button_group,children:[e.jsx("button",{onClick:o,className:b.give_up_button,children:"Yes, Give Up"}),e.jsx("button",{onClick:r,className:b.cancel_button,children:"No, Continue Playing"})]})]})})},se=({machineId:n,contestId:r,machineName:i,mode:u,disabled:a=!1})=>{const[d,l]=m.useState(!1),o=()=>{a||l(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:o,className:"give-up-button",disabled:a,style:{opacity:a?.5:1,cursor:a?"not-allowed":"pointer"},children:"Give Up"}),e.jsx(q,{isOpen:d,onClose:()=>l(!1),machineId:n,contestId:r,machineName:i,mode:u})]})};export{J as D,K as G,T as I,Q as S,Z as a,ee as b,se as c};
//# sourceMappingURL=GiveUpButton-D21FeauA.js.map
