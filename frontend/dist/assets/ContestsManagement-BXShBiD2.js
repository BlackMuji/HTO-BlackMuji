import{r,j as t}from"./index-CivGSquN.js";import{D as x,A as j,C as A}from"./ConfirmationModal-KRM3RTXK.js";import{S as p,E as C}from"./AdminSidebar-DtRlde2w.js";import{j as g,A as y,D,k as w}from"./axiosContest-a7qLFL0E.js";const b=()=>{const[d,c]=r.useState([]),[l,m]=r.useState(null),[o,n]=r.useState({isOpen:!1,contestId:void 0,action:void 0});r.useEffect(()=>{(async()=>{try{const s=await g();c(s.contests)}catch(s){console.error("Error fetching contests:",s),m("Failed to load contests.")}})()},[]);const v=(e,s)=>{n({isOpen:!0,contestId:e,action:s?"deactivate":"activate"})},f=e=>{n({isOpen:!0,contestId:e,action:"delete"})},u=async()=>{const{contestId:e,action:s}=o;if(!(!e||!s))try{s==="activate"?(await y(e),c(i=>i.map(a=>a._id===e?{...a,isActive:!0}:a))):s==="deactivate"?(await D(e),c(i=>i.map(a=>a._id===e?{...a,isActive:!1}:a))):s==="delete"&&(await w(e),c(i=>i.filter(a=>a._id!==e))),n({isOpen:!1,contestId:void 0,action:void 0})}catch(i){console.error(`Error performing ${s} on contest:`,i),m(`Failed to ${s} contest.`),n({isOpen:!1,contestId:void 0,action:void 0})}},h=[{header:"Name",accessor:"name"},{header:"Active",accessor:"isActive"},{header:"Start Time",accessor:"startTime"},{header:"End Time",accessor:"endTime"}];return t.jsxs("div",{className:"admin-dashboard",children:[t.jsx(p,{}),t.jsxs("div",{className:"admin-content",children:[t.jsx("h1",{children:"Contests Management"}),l&&t.jsx(C,{message:l}),t.jsx(x,{columns:h,data:d.map(e=>({...e,isActive:e.isActive?"Yes":"No"})),actions:void 0}),t.jsxs("table",{className:"data-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[h.map(e=>t.jsx("th",{children:e.header},e.accessor)),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:d.map(e=>t.jsxs("tr",{children:[t.jsx("td",{children:e.name}),t.jsx("td",{children:e.isActive?"Yes":"No"}),t.jsx("td",{children:new Date(e.startTime).toLocaleString()}),t.jsx("td",{children:new Date(e.endTime).toLocaleString()}),t.jsx("td",{children:t.jsx(j,{onActivate:e.isActive?void 0:()=>v(e._id,e.isActive),onDeactivate:e.isActive?()=>v(e._id,e.isActive):void 0,onDelete:()=>f(e._id)})})]},e._id))})]}),t.jsx(A,{isOpen:o.isOpen,title:o.action==="activate"?"Confirm Activate Contest":o.action==="deactivate"?"Confirm Deactivate Contest":"Confirm Delete Contest",message:o.action==="activate"?"Are you sure you want to activate this contest?":o.action==="deactivate"?"Are you sure you want to deactivate this contest?":"Are you sure you want to delete this contest? This action cannot be undone.",onConfirm:u,onCancel:()=>n({isOpen:!1,contestId:void 0,action:void 0})})]})]})};export{b as default};
//# sourceMappingURL=ContestsManagement-BXShBiD2.js.map
