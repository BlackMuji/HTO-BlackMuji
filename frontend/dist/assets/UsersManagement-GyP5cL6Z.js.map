{"version":3,"file":"UsersManagement-GyP5cL6Z.js","sources":["../../src/pages/admin/UsersManagement.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport DataTable from '../../components/admin/DataTable/DataTable';\r\nimport ActionButtons from '../../components/admin/ActionButtons';\r\nimport ConfirmationModal from '../../components/admin/ConfirmationModal';\r\nimport ErrorMessage from '../../components/admin/ErrorMessage';\r\nimport { \r\n  getAllUser, \r\n  makeUsertoAdmin, \r\n  deleteUserByUserId \r\n} from '../../api/axiosUser';\r\nimport Sidebar from '../../components/admin/AdminSidebar';\r\ninterface User {\r\n  _id: string;\r\n  username: string;\r\n  email: string;\r\n  isAdmin: boolean;\r\n}\r\n\r\nconst UsersManagement: React.FC = () => {\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [modal, setModal] = useState<{ isOpen: boolean; userId?: string; action?: string }>({\r\n    isOpen: false,\r\n    userId: undefined,\r\n    action: undefined,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchUsers = async () => {\r\n      try {\r\n        const res = await getAllUser();\r\n        setUsers(res.users);\r\n      } catch (err: any) {\r\n        console.error('Error fetching users:', err);\r\n        setError('Failed to load users.');\r\n      }\r\n    };\r\n\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  const handleMakeAdmin = (userId: string) => {\r\n    setModal({ isOpen: true, userId, action: 'makeAdmin' });\r\n  };\r\n\r\n  const handleDeleteUser = (userId: string) => {\r\n    setModal({ isOpen: true, userId, action: 'delete' });\r\n  };\r\n\r\n  const confirmAction = async () => {\r\n    const { userId, action } = modal;\r\n    if (!userId || !action) return;\r\n\r\n    try {\r\n      if (action === 'makeAdmin') {\r\n        await makeUsertoAdmin(userId);\r\n        setUsers((prevUsers) =>\r\n          prevUsers.map((user) =>\r\n            user._id === userId ? { ...user, isAdmin: true } : user\r\n          )\r\n        );\r\n      } else if (action === 'delete') {\r\n        await deleteUserByUserId(userId);\r\n        setUsers((prevUsers) => prevUsers.filter((user) => user._id !== userId));\r\n      }\r\n      setModal({ isOpen: false, userId: undefined, action: undefined });\r\n    } catch (err: any) {\r\n      console.error(`Error performing ${action}:`, err);\r\n      setError(`Failed to ${action === 'makeAdmin' ? 'make admin' : 'delete'} user.`);\r\n      setModal({ isOpen: false, userId: undefined, action: undefined });\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    { header: 'Username', accessor: 'username' },\r\n    { header: 'Email', accessor: 'email' },\r\n    { header: 'Admin', accessor: 'isAdmin' },\r\n  ];\r\n\r\n\r\n  return (\r\n    <div className=\"admin-dashboard\">\r\n      <Sidebar />\r\n      <div className=\"admin-content\">\r\n        <h1>Users Management</h1>\r\n        {error && <ErrorMessage message={error} />}\r\n        <DataTable columns={columns} data={users.map(user => ({\r\n          ...user,\r\n          isAdmin: user.isAdmin ? 'Yes' : 'No'\r\n        }))} actions={undefined} />\r\n        \r\n        {/* Render Action Buttons separately per row */}\r\n        <table className=\"data-table\">\r\n          <thead>\r\n            <tr>\r\n              {columns.map((col) => (\r\n                <th key={col.accessor}>{col.header}</th>\r\n              ))}\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {users.map(user => (\r\n              <tr key={user._id}>\r\n                <td>{user.username}</td>\r\n                <td>{user.email}</td>\r\n                <td>{user.isAdmin ? 'Yes' : 'No'}</td>\r\n                <td>\r\n                  <ActionButtons\r\n                    onActivate={!user.isAdmin ? () => handleMakeAdmin(user._id) : undefined}\r\n                    onDelete={() => handleDeleteUser(user._id)}\r\n                  />\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        \r\n        {/* Confirmation Modal */}\r\n        <ConfirmationModal\r\n          isOpen={modal.isOpen}\r\n          title={\r\n            modal.action === 'makeAdmin'\r\n              ? 'Confirm Promote to Admin'\r\n              : 'Confirm Delete User'\r\n          }\r\n          message={\r\n            modal.action === 'makeAdmin'\r\n              ? 'Are you sure you want to promote this user to admin?'\r\n              : 'Are you sure you want to delete this user? This action cannot be undone.'\r\n          }\r\n          onConfirm={confirmAction}\r\n          onCancel={() => setModal({ isOpen: false, userId: undefined, action: undefined })}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UsersManagement; "],"names":["UsersManagement","users","setUsers","useState","error","setError","modal","setModal","useEffect","res","getAllUser","err","handleMakeAdmin","userId","handleDeleteUser","confirmAction","action","makeUsertoAdmin","prevUsers","user","deleteUserByUserId","columns","jsxs","jsx","Sidebar","ErrorMessage","DataTable","col","ActionButtons","ConfirmationModal"],"mappings":"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"}